---
title: WGS84坐标系面积计算
published: 2025-08-29
description: "理解和计算WGS84坐标系下精细化的栅格面积"
tags: ["原理", "计算","GIS"]
category: 技术贴
draft: false
---
首先，需要明确几个知识点：

* 地球是一个两极稍扁、赤道略鼓的近椭球体。
* 类似于WGS84这种使用的是大地经纬度坐标，而不是地心经纬度，，如图1所示。前者指的是椭球体表面做法线与赤道平面的夹角为纬度$\varphi$，子午面NPS与本初子午面NGS的夹角$\lambda$为经度。


![受网络影响无法显示](https://cdn.jsdelivr.net/gh/ecohydrology-lab/web-sources@main/images/posts/2025-08-29/01.webp "图1. 大地经纬度图示")



<p align="center">图1. 大地经纬度图示</p>

沿面NPS将椭球体切开，其横截面为椭圆，如图2所示。其中对于大地椭球体，扁率=$(a-b)/a$，第一偏心率$e=\sqrt{(a^2-b^2)/a}$，第二偏心率$e'=\sqrt{(a^2-b^2)/b}$。

![受网络影响无法显示](https://cdn.jsdelivr.net/gh/ecohydrology-lab/web-sources@main/images/posts/2025-08-29/02.webp "图2. 地球横截面图示")


<p align="center">图2. 地球横截面图示</p>

要计算P点位置的微元近梯形面积，可以将其近似看作矩形，其中对于东西向矩形长度，需要让P点横坐标围绕NS旋转形成圆，该长度即为圆半径$x_0$旋转$d\lambda$形成的弧长$x_0·d\lambda=AP·cos\varphi·d\lambda$；对于南北向的矩形长度，需要计算P点子午圈曲率半径M，其长度为$Md\varphi$。

由此，我们可以进行接下来的计算，首先明确坐标 $(x,y)$与大地纬度$\varphi$的关系，对椭圆方程进行隐函数求导，可以得到：

$$
\frac{dy}{dx} = \frac{1}{tan\varphi}=\frac{x}{y}·\frac{b^2}{a^2}


$$

这里假设x,y都是正数，将上式平方后，结合椭圆方程即可得到：

$$
x=\frac{acos\varphi}{\sqrt{1-e^2sin^2\varphi}} \\[3ex]
y=\frac{a(1-e^2)sin\varphi}{\sqrt{1-e^2sin^2\varphi}} \\[3ex]
AP =N= \frac{a}{\sqrt{1-e^2sin^2\varphi}}
$$

对于P点子午圈曲率半径M，可以参考图3所示，曲率半径 $M=\frac{dS}{d\varphi}$。

![受网络影响无法显示](https://cdn.jsdelivr.net/gh/ecohydrology-lab/web-sources@main/images/posts/2025-08-29/03.webp "图3. 子午线曲率计算示意图")


<p align="center">图3. 子午线曲率计算示意图</p>

根据斜率关系，$-dS·sin\varphi=dx$，带入其中可以得到，$M= -sin\varphi \frac{dx}{d\varphi}$，又因为x与φ的解析式我们已经得到，因此可以求导计算结果，结果为：

$$
M = \frac{a(1-e^2)}{(1-e^2sin^2\varphi)^{3/2}}
$$

由此，我们就可以得到梯形的面积公式：

$$
A = \int_{\lambda_1}^{\lambda_2}\int_{\varphi_1}^{\varphi_2} Md\varphi·Ncos\varphi d\lambda\\
=\int_{\lambda_1}^{\lambda_2}\int_{\varphi_1}^{\varphi_2}\frac{a(1-e^2)}{(1-e^2sin^2\varphi)^{3/2}}·\frac{acos\varphi}{\sqrt{1-e^2sin^2\varphi}}d\varphi d\lambda\\
=a^2(\lambda_2-\lambda_1)(1-e^2)·\int_{\varphi_1}^{\varphi_2} \frac{cos\varphi}{(1-e^2sin^2\varphi)^2}d\varphi\\
=
a^2\left(1-e^2\right)\left(\lambda_2-\lambda_1\right)\left[\frac{sin B}{2\left(1-e^2 sin ^2 B\right)}+\frac{1}{4 e} ln \frac{1+e sin B}{1-e sin B}\right]_{\varphi_1}^{\varphi_2}
$$





<p align="right">——czc</p>
